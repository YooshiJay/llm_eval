Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
Loading checkpoint shards:  25%|██▌       | 1/4 [00:08<00:26,  8.67s/it]
Loading checkpoint shards:  50%|█████     | 2/4 [00:17<00:17,  8.78s/it]
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:24<00:07,  8.00s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:26<00:00,  5.41s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:26<00:00,  6.51s/it]

  0%|          | 0/83 [00:00<?, ?it/s][31m2024-05-20 16:41:26 [ERROR] [ -4280403,Out of memory ] cuMemAlloc(): fail to allocate 10719232 KB memory (out of memory)[0m

  1%|          | 1/83 [01:13<1:40:43, 73.70s/it]
  2%|▏         | 2/83 [01:51<1:11:17, 52.81s/it][31m2024-05-20 16:43:09 [ERROR] [ -4280403,Out of memory ] cuMemAlloc(): fail to allocate 10846208 KB memory (out of memory)[0m

  4%|▎         | 3/83 [02:26<59:04, 44.31s/it]  
  5%|▍         | 4/83 [02:52<49:12, 37.37s/it]
  6%|▌         | 5/83 [03:25<46:25, 35.71s/it]
  7%|▋         | 6/83 [03:55<43:13, 33.68s/it]
  8%|▊         | 7/83 [04:35<45:30, 35.92s/it]
 10%|▉         | 8/83 [05:09<44:09, 35.32s/it]
 11%|█         | 9/83 [05:41<41:58, 34.04s/it][31m2024-05-20 16:46:58 [ERROR] [ -4280403,Out of memory ] cuMemAlloc(): fail to allocate 10911744 KB memory (out of memory)[0m

 12%|█▏        | 10/83 [06:34<48:42, 40.03s/it]
 13%|█▎        | 11/83 [07:30<53:57, 44.96s/it]
 14%|█▍        | 12/83 [08:16<53:35, 45.29s/it]
 16%|█▌        | 13/83 [08:45<47:08, 40.41s/it]
 17%|█▋        | 14/83 [09:24<45:57, 39.96s/it]
 18%|█▊        | 15/83 [09:53<41:25, 36.55s/it]
 19%|█▉        | 16/83 [10:55<49:21, 44.20s/it]
 20%|██        | 17/83 [11:26<44:24, 40.38s/it]
 22%|██▏       | 18/83 [11:58<40:59, 37.83s/it]
 23%|██▎       | 19/83 [12:34<39:39, 37.17s/it]
 24%|██▍       | 20/83 [13:06<37:19, 35.55s/it]
 25%|██▌       | 21/83 [13:58<42:03, 40.70s/it]
 27%|██▋       | 22/83 [14:48<44:01, 43.30s/it]
 28%|██▊       | 23/83 [15:18<39:26, 39.45s/it]
 29%|██▉       | 24/83 [15:58<38:44, 39.40s/it]
 30%|███       | 25/83 [17:03<45:33, 47.13s/it]
 31%|███▏      | 26/83 [17:42<42:32, 44.78s/it]
 33%|███▎      | 27/83 [18:46<47:16, 50.64s/it]
 34%|███▎      | 28/83 [19:34<45:38, 49.78s/it][31m2024-05-20 17:00:51 [ERROR] [ -4280403,Out of memory ] cuMemAlloc(): fail to allocate 10942464 KB memory (out of memory)[0m

 35%|███▍      | 29/83 [20:04<39:22, 43.75s/it]
 36%|███▌      | 30/83 [20:28<33:25, 37.84s/it]
 37%|███▋      | 31/83 [21:00<31:11, 36.00s/it]
 39%|███▊      | 32/83 [21:52<34:53, 41.05s/it]
 40%|███▉      | 33/83 [22:20<30:48, 36.98s/it]
 41%|████      | 34/83 [22:53<29:16, 35.84s/it]
 42%|████▏     | 35/83 [23:30<28:54, 36.13s/it]
 43%|████▎     | 36/83 [24:09<28:56, 36.94s/it]
 45%|████▍     | 37/83 [24:50<29:14, 38.14s/it]
 46%|████▌     | 38/83 [25:28<28:44, 38.33s/it]
 47%|████▋     | 39/83 [26:00<26:31, 36.18s/it]
 48%|████▊     | 40/83 [26:43<27:23, 38.21s/it]
 49%|████▉     | 41/83 [27:22<26:55, 38.46s/it]
 51%|█████     | 42/83 [27:49<24:07, 35.30s/it]
 52%|█████▏    | 43/83 [28:34<25:18, 37.96s/it]
 53%|█████▎    | 44/83 [29:12<24:50, 38.21s/it]
 54%|█████▍    | 45/83 [29:58<25:39, 40.50s/it]
 55%|█████▌    | 46/83 [30:33<23:56, 38.82s/it]
 57%|█████▋    | 47/83 [31:17<24:07, 40.21s/it]
 58%|█████▊    | 48/83 [31:59<23:51, 40.90s/it]
 59%|█████▉    | 49/83 [32:52<25:07, 44.34s/it]
 60%|██████    | 50/83 [33:37<24:36, 44.74s/it]
 61%|██████▏   | 51/83 [34:13<22:25, 42.05s/it]
 63%|██████▎   | 52/83 [35:12<24:19, 47.07s/it]
 64%|██████▍   | 53/83 [35:57<23:19, 46.64s/it]
 65%|██████▌   | 54/83 [36:37<21:30, 44.48s/it]
 66%|██████▋   | 55/83 [37:25<21:19, 45.71s/it]
 67%|██████▋   | 56/83 [38:29<22:55, 50.94s/it]
 69%|██████▊   | 57/83 [39:23<22:27, 51.84s/it]
 70%|██████▉   | 58/83 [40:01<19:54, 47.79s/it]
 71%|███████   | 59/83 [40:48<19:01, 47.58s/it]
 72%|███████▏  | 60/83 [41:17<16:06, 42.03s/it]
 73%|███████▎  | 61/83 [41:48<14:11, 38.72s/it]
 75%|███████▍  | 62/83 [42:29<13:45, 39.30s/it]
 76%|███████▌  | 63/83 [43:08<13:06, 39.32s/it][31m2024-05-20 17:24:25 [ERROR] [ -4280403,Out of memory ] cuMemAlloc(): fail to allocate 10958848 KB memory (out of memory)[0m

 77%|███████▋  | 64/83 [43:48<12:31, 39.54s/it]
 78%|███████▊  | 65/83 [44:29<11:58, 39.92s/it]
 80%|███████▉  | 66/83 [45:05<11:01, 38.88s/it]
 81%|████████  | 67/83 [45:35<09:36, 36.01s/it][31m2024-05-20 17:26:52 [ERROR] [ -4280403,Out of memory ] cuMemAlloc(): fail to allocate 11335680 KB memory (out of memory)[0m

 82%|████████▏ | 68/83 [46:32<10:35, 42.38s/it]
 83%|████████▎ | 69/83 [47:19<10:12, 43.78s/it]
 84%|████████▍ | 70/83 [48:06<09:42, 44.83s/it]
 86%|████████▌ | 71/83 [48:49<08:50, 44.23s/it]
 87%|████████▋ | 72/83 [49:28<07:50, 42.75s/it]
 88%|████████▊ | 73/83 [50:12<07:10, 43.09s/it]
 89%|████████▉ | 74/83 [51:06<06:57, 46.39s/it]
 90%|█████████ | 75/83 [52:05<06:41, 50.21s/it]
 92%|█████████▏| 76/83 [52:44<05:27, 46.73s/it]
 93%|█████████▎| 77/83 [53:21<04:22, 43.67s/it]
 94%|█████████▍| 78/83 [54:16<03:55, 47.05s/it]
 95%|█████████▌| 79/83 [54:46<02:48, 42.01s/it]
 96%|█████████▋| 80/83 [55:30<02:07, 42.62s/it]
 98%|█████████▊| 81/83 [56:01<01:18, 39.09s/it]
 99%|█████████▉| 82/83 [56:56<00:44, 44.08s/it]
100%|██████████| 83/83 [57:28<00:00, 40.27s/it]
100%|██████████| 83/83 [57:28<00:00, 41.55s/it]
AVERAGE ACC:76.35 
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
Loading checkpoint shards:  25%|██▌       | 1/4 [00:16<00:50, 16.93s/it]
Loading checkpoint shards:  50%|█████     | 2/4 [00:35<00:35, 17.98s/it]
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:53<00:17, 17.78s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:56<00:00, 12.03s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:56<00:00, 14.10s/it]

  0%|          | 0/165 [00:00<?, ?it/s]
  1%|          | 1/165 [00:52<2:24:01, 52.69s/it]
  1%|          | 2/165 [01:55<2:38:42, 58.42s/it]
  2%|▏         | 3/165 [02:59<2:45:38, 61.35s/it]
  2%|▏         | 4/165 [03:35<2:17:16, 51.16s/it]
  3%|▎         | 5/165 [04:15<2:06:03, 47.27s/it][31m2024-05-20 18:01:19 [ERROR] [ -4280403,Out of memory ] cuMemAlloc(): fail to allocate 5423104 KB memory (out of memory)[0m

  4%|▎         | 6/165 [04:51<1:54:57, 43.38s/it]
  4%|▍         | 7/165 [05:35<1:54:48, 43.60s/it]
  5%|▍         | 8/165 [06:11<1:47:24, 41.05s/it]
  5%|▌         | 9/165 [06:42<1:38:38, 37.94s/it]
  6%|▌         | 10/165 [07:22<1:39:46, 38.62s/it]
  7%|▋         | 11/165 [07:57<1:36:03, 37.43s/it]
  7%|▋         | 12/165 [08:38<1:38:04, 38.46s/it]
  8%|▊         | 13/165 [09:21<1:40:58, 39.86s/it]
  8%|▊         | 14/165 [10:25<1:58:47, 47.20s/it]
  9%|▉         | 15/165 [11:09<1:55:24, 46.16s/it]
 10%|▉         | 16/165 [11:45<1:47:35, 43.33s/it]
 10%|█         | 17/165 [12:27<1:45:17, 42.69s/it]
 11%|█         | 18/165 [13:11<1:45:38, 43.12s/it][31m2024-05-20 18:10:15 [ERROR] [ -4280403,Out of memory ] cuMemAlloc(): fail to allocate 5455872 KB memory (out of memory)[0m

 12%|█▏        | 19/165 [13:51<1:43:04, 42.36s/it]
 12%|█▏        | 20/165 [15:13<2:10:51, 54.15s/it]
 13%|█▎        | 21/165 [16:17<2:17:05, 57.12s/it]
 13%|█▎        | 22/165 [17:24<2:22:55, 59.97s/it]
 14%|█▍        | 23/165 [18:32<2:28:03, 62.56s/it]
 15%|█▍        | 24/165 [19:25<2:19:50, 59.51s/it]
 15%|█▌        | 25/165 [20:04<2:04:57, 53.55s/it]
 16%|█▌        | 26/165 [20:44<1:54:45, 49.54s/it]
 16%|█▋        | 27/165 [21:40<1:58:07, 51.36s/it]
 17%|█▋        | 28/165 [22:19<1:48:32, 47.54s/it]
 18%|█▊        | 29/165 [22:55<1:40:09, 44.19s/it]
 18%|█▊        | 30/165 [23:32<1:34:29, 42.00s/it]
 19%|█▉        | 31/165 [24:14<1:33:56, 42.07s/it]
 19%|█▉        | 32/165 [25:31<1:56:41, 52.64s/it]
 20%|██        | 33/165 [26:34<2:02:05, 55.50s/it]
 21%|██        | 34/165 [27:17<1:53:17, 51.89s/it]
 21%|██        | 35/165 [27:59<1:45:39, 48.77s/it]
 22%|██▏       | 36/165 [29:18<2:04:22, 57.85s/it]
 22%|██▏       | 37/165 [30:03<1:55:14, 54.02s/it]
 23%|██▎       | 38/165 [30:55<1:53:29, 53.62s/it]
 24%|██▎       | 39/165 [31:33<1:42:29, 48.81s/it]
 24%|██▍       | 40/165 [32:16<1:38:06, 47.09s/it]
 25%|██▍       | 41/165 [33:16<1:45:04, 50.84s/it]
 25%|██▌       | 42/165 [33:55<1:36:57, 47.30s/it]
 26%|██▌       | 43/165 [34:56<1:44:30, 51.40s/it]
 27%|██▋       | 44/165 [35:26<1:31:07, 45.18s/it]
 27%|██▋       | 45/165 [36:20<1:35:28, 47.74s/it]
 28%|██▊       | 46/165 [36:59<1:29:12, 44.98s/it]
 28%|██▊       | 47/165 [37:58<1:36:45, 49.20s/it]
 29%|██▉       | 48/165 [38:37<1:29:55, 46.12s/it]
 30%|██▉       | 49/165 [39:18<1:26:23, 44.68s/it]
 30%|███       | 50/165 [39:54<1:20:52, 42.19s/it]
 31%|███       | 51/165 [40:32<1:17:35, 40.84s/it]
 32%|███▏      | 52/165 [41:21<1:21:33, 43.30s/it]
 32%|███▏      | 53/165 [42:19<1:29:19, 47.85s/it]
 33%|███▎      | 54/165 [43:28<1:39:47, 53.94s/it]
 33%|███▎      | 55/165 [44:49<1:54:04, 62.22s/it]
 34%|███▍      | 56/165 [45:28<1:40:22, 55.25s/it]
 35%|███▍      | 57/165 [46:07<1:30:30, 50.28s/it][31m2024-05-20 18:43:11 [ERROR] [ -4280403,Out of memory ] cuMemAlloc(): fail to allocate 5472256 KB memory (out of memory)[0m

 35%|███▌      | 58/165 [46:43<1:22:03, 46.02s/it]
 36%|███▌      | 59/165 [47:17<1:14:45, 42.32s/it]
 36%|███▋      | 60/165 [48:04<1:16:59, 43.99s/it]
 37%|███▋      | 61/165 [48:47<1:15:18, 43.45s/it]
 38%|███▊      | 62/165 [49:30<1:14:33, 43.44s/it]
 38%|███▊      | 63/165 [50:05<1:09:37, 40.96s/it]
 39%|███▉      | 64/165 [50:58<1:14:52, 44.48s/it]
 39%|███▉      | 65/165 [51:31<1:08:17, 40.98s/it]
 40%|████      | 66/165 [52:14<1:08:48, 41.70s/it]
 41%|████      | 67/165 [52:54<1:07:27, 41.30s/it]
 41%|████      | 68/165 [53:38<1:07:58, 42.05s/it]
 42%|████▏     | 69/165 [54:15<1:04:44, 40.47s/it]
 42%|████▏     | 70/165 [55:02<1:06:57, 42.29s/it]
 43%|████▎     | 71/165 [55:39<1:03:47, 40.72s/it]
 44%|████▎     | 72/165 [56:43<1:14:00, 47.74s/it]
 44%|████▍     | 73/165 [57:24<1:10:19, 45.87s/it]
 45%|████▍     | 74/165 [58:20<1:14:02, 48.82s/it]
 45%|████▌     | 75/165 [59:00<1:09:03, 46.04s/it]
 46%|████▌     | 76/165 [59:31<1:01:44, 41.62s/it]
 47%|████▋     | 77/165 [1:00:23<1:05:29, 44.65s/it]
 47%|████▋     | 78/165 [1:00:53<58:39, 40.45s/it]  
 48%|████▊     | 79/165 [1:01:30<56:35, 39.49s/it]
 48%|████▊     | 80/165 [1:02:27<1:03:18, 44.69s/it]
 49%|████▉     | 81/165 [1:02:58<56:47, 40.57s/it]  
 50%|████▉     | 82/165 [1:03:32<53:27, 38.65s/it]
 50%|█████     | 83/165 [1:04:14<53:57, 39.48s/it]
 51%|█████     | 84/165 [1:04:50<51:49, 38.39s/it]
 52%|█████▏    | 85/165 [1:05:34<53:30, 40.13s/it]
 52%|█████▏    | 86/165 [1:06:35<1:01:02, 46.36s/it]
 53%|█████▎    | 87/165 [1:07:14<57:39, 44.36s/it]  
 53%|█████▎    | 88/165 [1:07:59<57:00, 44.42s/it]
 54%|█████▍    | 89/165 [1:08:34<52:47, 41.67s/it]
 55%|█████▍    | 90/165 [1:09:08<48:59, 39.20s/it]
 55%|█████▌    | 91/165 [1:09:51<49:53, 40.46s/it]
 56%|█████▌    | 92/165 [1:10:29<48:13, 39.64s/it]
 56%|█████▋    | 93/165 [1:11:24<53:13, 44.35s/it]
 57%|█████▋    | 94/165 [1:12:12<53:53, 45.54s/it]
 58%|█████▊    | 95/165 [1:13:08<56:37, 48.54s/it]
 58%|█████▊    | 96/165 [1:14:05<58:47, 51.13s/it]
 59%|█████▉    | 97/165 [1:14:41<52:54, 46.68s/it]
 59%|█████▉    | 98/165 [1:15:48<58:50, 52.69s/it]
 60%|██████    | 99/165 [1:16:30<54:26, 49.49s/it]
 61%|██████    | 100/165 [1:17:08<49:46, 45.94s/it]
 61%|██████    | 101/165 [1:17:50<47:41, 44.70s/it]
 62%|██████▏   | 102/165 [1:18:40<48:41, 46.37s/it]
 62%|██████▏   | 103/165 [1:19:07<41:56, 40.59s/it]
 63%|██████▎   | 104/165 [1:19:51<42:14, 41.55s/it]
 64%|██████▎   | 105/165 [1:20:24<39:09, 39.16s/it]
 64%|██████▍   | 106/165 [1:21:23<44:17, 45.05s/it]
 65%|██████▍   | 107/165 [1:22:11<44:17, 45.81s/it]
 65%|██████▌   | 108/165 [1:22:51<42:01, 44.24s/it]
 66%|██████▌   | 109/165 [1:23:32<40:11, 43.07s/it]
 67%|██████▋   | 110/165 [1:24:08<37:34, 40.99s/it]
 67%|██████▋   | 111/165 [1:24:58<39:22, 43.75s/it]
 68%|██████▊   | 112/165 [1:25:47<40:08, 45.44s/it]
 68%|██████▊   | 113/165 [1:26:30<38:40, 44.62s/it]
 69%|██████▉   | 114/165 [1:27:06<35:42, 42.00s/it]
 70%|██████▉   | 115/165 [1:27:51<35:47, 42.95s/it]
 70%|███████   | 116/165 [1:28:35<35:11, 43.09s/it]
 71%|███████   | 117/165 [1:29:56<43:47, 54.73s/it]
 72%|███████▏  | 118/165 [1:30:35<38:59, 49.77s/it]
 72%|███████▏  | 119/165 [1:31:10<34:43, 45.30s/it]
 73%|███████▎  | 120/165 [1:31:46<32:00, 42.69s/it]
 73%|███████▎  | 121/165 [1:32:30<31:35, 43.09s/it]
 74%|███████▍  | 122/165 [1:33:11<30:28, 42.52s/it]
 75%|███████▍  | 123/165 [1:34:05<32:10, 45.97s/it]
 75%|███████▌  | 124/165 [1:34:50<31:07, 45.55s/it]
 76%|███████▌  | 125/165 [1:35:41<31:24, 47.12s/it]
 76%|███████▋  | 126/165 [1:36:26<30:18, 46.63s/it][31m2024-05-20 19:33:30 [ERROR] [ -4280403,Out of memory ] cuMemAlloc(): fail to allocate 5480448 KB memory (out of memory)[0m

 77%|███████▋  | 127/165 [1:37:21<31:10, 49.22s/it]
 78%|███████▊  | 128/165 [1:38:43<36:19, 58.90s/it]
 78%|███████▊  | 129/165 [1:39:20<31:23, 52.31s/it]
 79%|███████▉  | 130/165 [1:40:09<29:53, 51.25s/it]
 79%|███████▉  | 131/165 [1:40:56<28:20, 50.00s/it]
 80%|████████  | 132/165 [1:41:33<25:26, 46.26s/it]
 81%|████████  | 133/165 [1:42:08<22:51, 42.86s/it]
 81%|████████  | 134/165 [1:42:47<21:33, 41.72s/it][31m2024-05-20 19:39:51 [ERROR] [ -4280403,Out of memory ] cuMemAlloc(): fail to allocate 5668864 KB memory (out of memory)[0m
[31m2024-05-20 19:39:58 [ERROR] [ -4280403,Out of memory ] cuMemAlloc(): fail to allocate 5668864 KB memory (out of memory)[0m

 81%|████████  | 134/165 [1:42:58<23:49, 46.11s/it]
Traceback (most recent call last):
  File "/gemini/code/lamma3_eval/eval_code/eval_gsm8k_chat.py", line 256, in <module>
    main()
  File "/root/miniconda3/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/gemini/code/lamma3_eval/eval_code/eval_gsm8k_chat.py", line 227, in main
    completion = generate_sample(model, tokenizer, context)
  File "/gemini/code/lamma3_eval/eval_code/eval_gsm8k_chat.py", line 147, in generate_sample
    outputs_id = model.generate(**input_ids, max_new_tokens = 512, eos_token_id = 128009, pad_token_id = tokenizer.pad_token_id,
  File "/root/miniconda3/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/root/miniconda3/lib/python3.10/site-packages/transformers/generation/utils.py", line 1576, in generate
    result = self._greedy_search(
  File "/root/miniconda3/lib/python3.10/site-packages/transformers/generation/utils.py", line 2494, in _greedy_search
    outputs = self(
  File "/root/miniconda3/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/miniconda3/lib/python3.10/site-packages/transformers/models/llama/modeling_llama.py", line 1229, in forward
    logits = self.lm_head(hidden_states)
  File "/root/miniconda3/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/miniconda3/lib/python3.10/site-packages/torch/nn/modules/linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 5.41 GiB (GPU 0; 44.84 GiB total capacity; 33.11 GiB already allocated; 4.65 GiB free; 39.20 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
Loading checkpoint shards:  25%|██▌       | 1/4 [00:17<00:51, 17.15s/it]
Loading checkpoint shards:  50%|█████     | 2/4 [00:36<00:36, 18.20s/it]
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:55<00:18, 18.53s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:58<00:00, 12.67s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:58<00:00, 14.67s/it]

  0%|          | 0/220 [00:00<?, ?it/s]
  0%|          | 1/220 [00:33<2:02:54, 33.67s/it]
  1%|          | 2/220 [01:09<2:07:46, 35.17s/it]
  1%|▏         | 3/220 [02:03<2:38:11, 43.74s/it]
  2%|▏         | 4/220 [03:00<2:55:37, 48.78s/it]
  2%|▏         | 5/220 [03:30<2:30:13, 41.92s/it]
  3%|▎         | 6/220 [04:01<2:16:33, 38.29s/it]
  3%|▎         | 7/220 [04:35<2:11:43, 37.10s/it]
  4%|▎         | 8/220 [05:04<2:01:44, 34.46s/it]
  4%|▍         | 9/220 [05:41<2:03:56, 35.24s/it]
  5%|▍         | 10/220 [06:11<1:57:26, 33.55s/it]
  5%|▌         | 11/220 [06:40<1:51:46, 32.09s/it]
  5%|▌         | 12/220 [07:06<1:44:43, 30.21s/it]
  6%|▌         | 13/220 [07:39<1:46:57, 31.00s/it]
  6%|▋         | 14/220 [08:12<1:49:16, 31.83s/it]
  7%|▋         | 15/220 [08:42<1:46:54, 31.29s/it]
  7%|▋         | 16/220 [09:17<1:50:00, 32.36s/it]
  8%|▊         | 17/220 [09:56<1:56:24, 34.41s/it]
  8%|▊         | 18/220 [10:53<2:17:59, 40.99s/it]
  9%|▊         | 19/220 [11:44<2:27:19, 43.98s/it]
  9%|▉         | 20/220 [12:21<2:20:29, 42.15s/it]
 10%|▉         | 21/220 [12:52<2:07:54, 38.57s/it]
 10%|█         | 22/220 [13:27<2:04:05, 37.61s/it]
 10%|█         | 23/220 [13:55<1:53:32, 34.58s/it]
 11%|█         | 24/220 [14:33<1:56:58, 35.81s/it]
 11%|█▏        | 25/220 [15:07<1:54:25, 35.21s/it]
 12%|█▏        | 26/220 [16:18<2:28:43, 46.00s/it]
 12%|█▏        | 27/220 [16:45<2:09:13, 40.17s/it]
 13%|█▎        | 28/220 [17:40<2:23:05, 44.71s/it]
 13%|█▎        | 29/220 [18:37<2:34:16, 48.46s/it]
 14%|█▎        | 30/220 [19:09<2:17:21, 43.38s/it]
 14%|█▍        | 31/220 [20:09<2:32:09, 48.30s/it]
 15%|█▍        | 32/220 [20:45<2:19:51, 44.64s/it]
 15%|█▌        | 33/220 [21:19<2:09:00, 41.39s/it]
 15%|█▌        | 34/220 [21:50<1:58:56, 38.37s/it]
 16%|█▌        | 35/220 [22:24<1:54:46, 37.22s/it]
 16%|█▋        | 36/220 [23:12<2:03:44, 40.35s/it]
 17%|█▋        | 37/220 [23:46<1:57:04, 38.39s/it]
 17%|█▋        | 38/220 [24:17<1:49:52, 36.22s/it]
 18%|█▊        | 39/220 [24:44<1:41:15, 33.57s/it]
 18%|█▊        | 40/220 [25:16<1:38:38, 32.88s/it]
 19%|█▊        | 41/220 [25:53<1:42:10, 34.25s/it]
 19%|█▉        | 42/220 [27:00<2:10:56, 44.14s/it]
 20%|█▉        | 43/220 [27:34<2:01:06, 41.06s/it]
 20%|██        | 44/220 [28:26<2:09:37, 44.19s/it]
 20%|██        | 45/220 [29:02<2:01:43, 41.74s/it]
 21%|██        | 46/220 [29:36<1:54:42, 39.55s/it]
 21%|██▏       | 47/220 [30:07<1:46:06, 36.80s/it]
 22%|██▏       | 48/220 [31:14<2:11:41, 45.94s/it]
 22%|██▏       | 49/220 [31:54<2:06:02, 44.22s/it]
 23%|██▎       | 50/220 [32:25<1:53:38, 40.11s/it]
 23%|██▎       | 51/220 [33:10<1:57:13, 41.62s/it]
 24%|██▎       | 52/220 [33:40<1:47:10, 38.28s/it]
 24%|██▍       | 53/220 [34:18<1:46:25, 38.24s/it]
 25%|██▍       | 54/220 [35:11<1:57:35, 42.50s/it]
 25%|██▌       | 55/220 [35:46<1:51:08, 40.42s/it]
 25%|██▌       | 56/220 [36:18<1:43:35, 37.90s/it]
 26%|██▌       | 57/220 [37:12<1:55:52, 42.66s/it]
 26%|██▋       | 58/220 [37:35<1:39:02, 36.68s/it]
 27%|██▋       | 59/220 [38:10<1:37:33, 36.36s/it]
 27%|██▋       | 60/220 [38:58<1:46:10, 39.82s/it]
 28%|██▊       | 61/220 [39:29<1:38:29, 37.17s/it]
 28%|██▊       | 62/220 [40:21<1:49:12, 41.47s/it]
 29%|██▊       | 63/220 [40:50<1:38:43, 37.73s/it]
 29%|██▉       | 64/220 [41:23<1:34:12, 36.23s/it]
 30%|██▉       | 65/220 [41:55<1:30:27, 35.02s/it]
 30%|███       | 66/220 [42:30<1:30:12, 35.15s/it]
 30%|███       | 67/220 [42:55<1:21:35, 31.99s/it]
 31%|███       | 68/220 [43:28<1:21:44, 32.27s/it]
 31%|███▏      | 69/220 [44:11<1:29:31, 35.58s/it]
 32%|███▏      | 70/220 [44:45<1:27:45, 35.10s/it]
 32%|███▏      | 71/220 [45:36<1:39:11, 39.94s/it]
 33%|███▎      | 72/220 [46:35<1:52:24, 45.57s/it]
 33%|███▎      | 73/220 [47:47<2:11:01, 53.48s/it]
 34%|███▎      | 74/220 [48:20<1:55:21, 47.41s/it]
 34%|███▍      | 75/220 [48:53<1:43:43, 42.92s/it]
 35%|███▍      | 76/220 [49:26<1:36:04, 40.03s/it][31m2024-05-20 20:49:20 [ERROR] [ -4280403,Out of memory ] cuMemAlloc(): fail to allocate 4104192 KB memory (out of memory)[0m

 35%|███▌      | 77/220 [49:59<1:30:13, 37.86s/it]
 35%|███▌      | 78/220 [50:27<1:23:02, 35.09s/it]
 36%|███▌      | 79/220 [50:56<1:17:53, 33.15s/it]
 36%|███▋      | 80/220 [51:39<1:24:29, 36.21s/it]
 37%|███▋      | 81/220 [52:16<1:24:18, 36.39s/it]
 37%|███▋      | 82/220 [52:43<1:17:11, 33.56s/it]
 38%|███▊      | 83/220 [53:21<1:19:34, 34.85s/it]
 38%|███▊      | 84/220 [53:51<1:15:27, 33.29s/it]
 39%|███▊      | 85/220 [54:30<1:18:57, 35.10s/it]
 39%|███▉      | 86/220 [55:14<1:24:22, 37.78s/it]
 40%|███▉      | 87/220 [55:51<1:23:03, 37.47s/it]
 40%|████      | 88/220 [56:23<1:18:58, 35.89s/it]
 40%|████      | 89/220 [56:57<1:17:18, 35.41s/it]
 41%|████      | 90/220 [57:24<1:11:18, 32.91s/it]
 41%|████▏     | 91/220 [58:03<1:14:38, 34.72s/it]
 42%|████▏     | 92/220 [58:35<1:12:04, 33.78s/it]
 42%|████▏     | 93/220 [59:03<1:08:09, 32.20s/it]
 43%|████▎     | 94/220 [59:45<1:13:24, 34.96s/it]
 43%|████▎     | 95/220 [1:00:29<1:18:42, 37.78s/it]
 44%|████▎     | 96/220 [1:01:25<1:29:10, 43.15s/it]
 44%|████▍     | 97/220 [1:02:02<1:25:10, 41.55s/it]
 45%|████▍     | 98/220 [1:02:51<1:28:40, 43.61s/it]
 45%|████▌     | 99/220 [1:03:25<1:22:26, 40.88s/it]
 45%|████▌     | 100/220 [1:04:01<1:18:17, 39.14s/it]
 46%|████▌     | 101/220 [1:04:27<1:10:19, 35.46s/it]
 46%|████▋     | 102/220 [1:05:12<1:15:17, 38.29s/it]
 47%|████▋     | 103/220 [1:05:42<1:09:42, 35.74s/it]
 47%|████▋     | 104/220 [1:06:08<1:03:25, 32.81s/it]
 48%|████▊     | 105/220 [1:06:36<1:00:10, 31.40s/it]
 48%|████▊     | 106/220 [1:07:25<1:09:40, 36.67s/it]
 49%|████▊     | 107/220 [1:07:55<1:05:24, 34.73s/it]
 49%|████▉     | 108/220 [1:08:19<58:30, 31.34s/it]  
 50%|████▉     | 109/220 [1:08:47<56:24, 30.49s/it]
 50%|█████     | 110/220 [1:09:18<56:08, 30.62s/it]
 50%|█████     | 111/220 [1:09:53<58:02, 31.95s/it]
 51%|█████     | 112/220 [1:10:21<55:30, 30.84s/it]
 51%|█████▏    | 113/220 [1:10:58<58:00, 32.52s/it]
 52%|█████▏    | 114/220 [1:11:46<1:05:47, 37.24s/it]
 52%|█████▏    | 115/220 [1:12:39<1:13:28, 41.99s/it]
 53%|█████▎    | 116/220 [1:13:14<1:08:52, 39.74s/it]
 53%|█████▎    | 117/220 [1:13:50<1:06:14, 38.59s/it]
 54%|█████▎    | 118/220 [1:14:28<1:05:43, 38.66s/it]
 54%|█████▍    | 119/220 [1:14:59<1:00:51, 36.15s/it]
 55%|█████▍    | 120/220 [1:15:27<56:19, 33.79s/it]  
 55%|█████▌    | 121/220 [1:16:04<57:08, 34.63s/it]
 55%|█████▌    | 122/220 [1:16:41<57:49, 35.40s/it]
 56%|█████▌    | 123/220 [1:17:12<55:24, 34.27s/it]
 56%|█████▋    | 124/220 [1:18:00<1:01:07, 38.20s/it]
 57%|█████▋    | 125/220 [1:18:43<1:02:50, 39.69s/it]
 57%|█████▋    | 126/220 [1:19:30<1:05:43, 41.95s/it]
 58%|█████▊    | 127/220 [1:20:05<1:01:54, 39.94s/it]
 58%|█████▊    | 128/220 [1:20:53<1:04:39, 42.17s/it]
 59%|█████▊    | 129/220 [1:21:24<58:43, 38.72s/it]  
 59%|█████▉    | 130/220 [1:22:06<59:37, 39.75s/it]
 60%|█████▉    | 131/220 [1:23:05<1:07:28, 45.48s/it]
 60%|██████    | 132/220 [1:23:29<57:14, 39.02s/it]  
 60%|██████    | 133/220 [1:24:00<53:23, 36.83s/it]
 61%|██████    | 134/220 [1:24:32<50:29, 35.23s/it]
 61%|██████▏   | 135/220 [1:25:10<51:00, 36.01s/it]
 62%|██████▏   | 136/220 [1:25:52<53:09, 37.97s/it]
 62%|██████▏   | 137/220 [1:26:15<46:09, 33.36s/it]
 63%|██████▎   | 138/220 [1:26:53<47:35, 34.82s/it]
 63%|██████▎   | 139/220 [1:27:26<46:27, 34.41s/it]
 64%|██████▎   | 140/220 [1:27:55<43:42, 32.78s/it]
 64%|██████▍   | 141/220 [1:28:46<50:21, 38.25s/it]
 65%|██████▍   | 142/220 [1:29:16<46:23, 35.69s/it]
 65%|██████▌   | 143/220 [1:29:58<48:10, 37.53s/it]
 65%|██████▌   | 144/220 [1:30:31<45:52, 36.22s/it]
 66%|██████▌   | 145/220 [1:31:05<44:32, 35.63s/it]
 66%|██████▋   | 146/220 [1:31:36<41:58, 34.03s/it]
 67%|██████▋   | 147/220 [1:32:06<40:12, 33.05s/it]
 67%|██████▋   | 148/220 [1:32:50<43:18, 36.08s/it]
 68%|██████▊   | 149/220 [1:33:31<44:34, 37.68s/it]
 68%|██████▊   | 150/220 [1:34:12<45:15, 38.80s/it]
 69%|██████▊   | 151/220 [1:34:51<44:31, 38.71s/it]
 69%|██████▉   | 152/220 [1:35:21<41:07, 36.29s/it]
 70%|██████▉   | 153/220 [1:35:54<39:21, 35.24s/it]
 70%|███████   | 154/220 [1:36:34<40:22, 36.71s/it]
 70%|███████   | 155/220 [1:37:09<39:10, 36.16s/it]
 71%|███████   | 156/220 [1:38:21<49:49, 46.71s/it]
 71%|███████▏  | 157/220 [1:38:55<45:03, 42.91s/it]
 72%|███████▏  | 158/220 [1:39:26<40:47, 39.48s/it]
 72%|███████▏  | 159/220 [1:39:58<37:42, 37.09s/it]
 73%|███████▎  | 160/220 [1:40:29<35:23, 35.38s/it]
 73%|███████▎  | 161/220 [1:41:07<35:23, 36.00s/it]
 74%|███████▎  | 162/220 [1:41:42<34:45, 35.95s/it]
 74%|███████▍  | 163/220 [1:42:29<37:08, 39.10s/it]
 75%|███████▍  | 164/220 [1:42:58<33:49, 36.23s/it]
 75%|███████▌  | 165/220 [1:43:34<33:09, 36.18s/it]
 75%|███████▌  | 166/220 [1:44:13<33:11, 36.89s/it]
 76%|███████▌  | 167/220 [1:44:57<34:32, 39.10s/it]
 76%|███████▋  | 168/220 [1:45:37<33:57, 39.18s/it]
 77%|███████▋  | 169/220 [1:46:23<35:05, 41.29s/it]
 77%|███████▋  | 170/220 [1:46:56<32:29, 38.99s/it]
 78%|███████▊  | 171/220 [1:48:06<39:18, 48.12s/it]
 78%|███████▊  | 172/220 [1:48:40<35:03, 43.82s/it]
 79%|███████▊  | 173/220 [1:49:08<30:42, 39.21s/it]
 79%|███████▉  | 174/220 [1:49:50<30:45, 40.12s/it]
 80%|███████▉  | 175/220 [1:50:31<30:14, 40.32s/it]
 80%|████████  | 176/220 [1:51:02<27:34, 37.59s/it]
 80%|████████  | 177/220 [1:51:32<25:16, 35.26s/it]
 81%|████████  | 178/220 [1:51:59<22:58, 32.82s/it]
 81%|████████▏ | 179/220 [1:52:46<25:11, 36.88s/it][31m2024-05-20 21:52:40 [ERROR] [ -4280403,Out of memory ] cuMemAlloc(): fail to allocate 4251648 KB memory (out of memory)[0m

 82%|████████▏ | 180/220 [1:53:23<24:46, 37.16s/it]
 82%|████████▏ | 181/220 [1:54:02<24:31, 37.72s/it]
 83%|████████▎ | 182/220 [1:54:57<27:03, 42.72s/it]
 83%|████████▎ | 183/220 [1:55:42<26:44, 43.37s/it]
 84%|████████▎ | 184/220 [1:56:15<24:15, 40.44s/it]
 84%|████████▍ | 185/220 [1:56:56<23:34, 40.41s/it]
 85%|████████▍ | 186/220 [1:57:35<22:45, 40.16s/it]
 85%|████████▌ | 187/220 [1:58:06<20:34, 37.41s/it]
 85%|████████▌ | 188/220 [1:58:55<21:43, 40.73s/it]
 86%|████████▌ | 189/220 [1:59:36<21:05, 40.83s/it]
 86%|████████▋ | 190/220 [2:00:17<20:26, 40.89s/it]
 87%|████████▋ | 191/220 [2:00:48<18:17, 37.83s/it]
 87%|████████▋ | 192/220 [2:01:31<18:26, 39.53s/it]
 88%|████████▊ | 193/220 [2:02:22<19:22, 43.05s/it]
 88%|████████▊ | 194/220 [2:02:59<17:49, 41.13s/it]
 89%|████████▊ | 195/220 [2:03:58<19:24, 46.59s/it]
 89%|████████▉ | 196/220 [2:04:35<17:26, 43.59s/it]
 90%|████████▉ | 197/220 [2:05:24<17:21, 45.26s/it]
 90%|█████████ | 198/220 [2:06:11<16:45, 45.69s/it]
 90%|█████████ | 199/220 [2:06:50<15:19, 43.78s/it]
 91%|█████████ | 200/220 [2:07:26<13:51, 41.56s/it]
 91%|█████████▏| 201/220 [2:08:02<12:35, 39.74s/it]
 92%|█████████▏| 202/220 [2:08:30<10:54, 36.34s/it]
 92%|█████████▏| 203/220 [2:09:13<10:51, 38.33s/it]
 93%|█████████▎| 204/220 [2:09:54<10:23, 38.97s/it]
 93%|█████████▎| 205/220 [2:10:23<09:02, 36.14s/it]
 94%|█████████▎| 206/220 [2:10:54<08:04, 34.58s/it]
 94%|█████████▍| 207/220 [2:11:26<07:16, 33.61s/it]
 95%|█████████▍| 208/220 [2:11:58<06:39, 33.32s/it]
 95%|█████████▌| 209/220 [2:12:34<06:15, 34.10s/it]
 95%|█████████▌| 210/220 [2:13:05<05:29, 33.00s/it]
 96%|█████████▌| 211/220 [2:13:44<05:14, 34.91s/it]
 96%|█████████▋| 212/220 [2:14:12<04:22, 32.81s/it]
 97%|█████████▋| 213/220 [2:15:00<04:21, 37.43s/it]
 97%|█████████▋| 214/220 [2:15:30<03:31, 35.27s/it]
 98%|█████████▊| 215/220 [2:16:06<02:57, 35.46s/it]
 98%|█████████▊| 216/220 [2:16:35<02:13, 33.32s/it]
 99%|█████████▊| 217/220 [2:17:07<01:39, 33.02s/it]
 99%|█████████▉| 218/220 [2:17:50<01:12, 36.16s/it]
100%|█████████▉| 219/220 [2:18:29<00:36, 36.88s/it]
100%|██████████| 220/220 [2:19:15<00:00, 39.78s/it]
100%|██████████| 220/220 [2:19:15<00:00, 37.98s/it]
AVERAGE ACC:77.03 


Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
Loading checkpoint shards:  25%|██▌       | 1/4 [00:18<00:54, 18.10s/it]
Loading checkpoint shards:  50%|█████     | 2/4 [00:37<00:37, 18.74s/it]
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:54<00:18, 18.20s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:58<00:00, 12.38s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:58<00:00, 14.57s/it]

100%|██████████| 57/57 [2:39:16<00:00, 127.99s/it]
100%|██████████| 57/57 [2:39:16<00:00, 167.66s/it]
AVERAGE ACC:65.47 
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.


Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
Loading checkpoint shards:  25%|██▌       | 1/4 [00:16<00:49, 16.64s/it]
Loading checkpoint shards:  50%|█████     | 2/4 [00:32<00:32, 16.13s/it]
Loading checkpoint shards:  75%|███████▌  | 3/4 [00:50<00:16, 16.99s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:53<00:00, 11.57s/it]
Loading checkpoint shards: 100%|██████████| 4/4 [00:53<00:00, 13.42s/it]

100%|██████████| 57/57 [2:39:53<00:00, 129.62s/it]
100%|██████████| 57/57 [2:39:53<00:00, 168.31s/it]
AVERAGE ACC:67.14 
